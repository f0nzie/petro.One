library(testthat)

# skip("skip")
skip_on_cran()
skip_on_travis()

context("Document types that were not uniform")
test_that("", {
    my_url <- make_search_url(query = "deepwater",
                              dc_type = "other")
    expect_equal(get_papers_count(my_url), 12)
    expect_equal(dim(onepetro_page_to_dataframe(my_url)), c(10, 6))
})


context("Problem: returns 0 rows when it had 69")
test_that("", {
    my_url <- make_search_url(query = "deepwater", dc_type = 'media')

    expect_equal(get_papers_count(my_url), 73)
    print(dim(onepetro_page_to_dataframe(my_url)))
    # expect_equal(dim(onepetro_page_to_dataframe(my_url)), c(10, 6))
})


context("dc_type return different number of columns")
test_that("", {
    my_url <- make_search_url(query = "unconventional",
                          rows = 1000)

    # cat(get_papers_count(my_url))
    expect_equal(get_papers_count(my_url), 19682)
    # 16359
    # 17843

    expect_equal(dim(onepetro_page_to_dataframe(my_url)), c(1000, 6))
    # Chapter	            1
    # Conference paper	14846
    # General	           42
    # Journal paper	     2701
    # Media	               71
    # Other	               26
    # Presentation	      155
    # Standard	            1
    by_type <- papers_by_type(my_url)
    # cat(by_type$value)
    expect_equal(by_type$value, c(1, 16364, 43, 2932, 76, 26, 239, 1))
    expect_equal(sum(by_type$value), 19682)
})
